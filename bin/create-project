#!/bin/bash
source `dirname $0`/config.sh

if [ -z $1 ]; then
    echo "Need to specify name"
    exit -1
else
    G8TEMPLATE="$HOME/.omnia/tooling.omnia.g8"
    if [ ! -d $G8TEMPLATE ]; then
        git clone "ssh://git@stash.dev.cba:7999/omnia/tooling.omnia.g8.git" $G8TEMPLATE
    else
        cd $G8TEMPLATE
        git fetch "ssh://git@stash.dev.cba:7999/omnia/tooling.omnia.g8.git" master
        git reset --hard origin/master
        cd -
    fi


    java -jar $LEVI_PATH create-project \
        --user $USER \
        --stash-url $STASH_URL \
        --git-url $GIT_URL \
        --teamcity-url $TEAMCITY_URL \
        --teamcity-user $TEAMCITY_USER \
        --artifactory-url $ARTIFACTORY_URL \
        --artifactory-password "\"$ARTIFACTORY_PASSWORD\"" \
        --artifactory-repos $ARTIFACTORY_REPOS \
        --project $STASH_PROJECT \
        --g8-template "file://$G8TEMPLATE" \
        --teamcity-template "BuildReleaseTemplate" \
        --name $1


fi
